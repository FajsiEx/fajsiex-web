<div class="container">
	<div class="timeline">
		<div class="sorter">
			<!-- <div class="project" [class.active]="!filter" (click)="switchFilter(false)">
				<div class="filter-name"><a>All</a></div>
			</div> -->

			<a *ngIf="filter" (click)="switchFilter(false)" class="reset-filter-link">
				<i class="fas fa-chevron-left"></i>
				&nbsp;
				Show news and changelogs for all projects
			</a>

			<br>
			<br>

			<div class="project-row">
				<div class="project-wrapper" *ngFor="let project of projects">
					<div class="project"
						[ngClass]="{active: filter==project.id, high: filter==project.id || !filter}"
						(click)="switchFilter(project.id)" [attr.project-id]="project.id">
						<div class="border"></div>
						<div>
							<div class="filter-name">
								<a>{{project.name}}</a>
							</div>
							<span class="build">{{project.buildNumbers.stable}}</span><br>
							<span class="build" *ngIf="project.buildNumbers.beta">{{project.buildNumbers.beta}}</span>
							<span class="build" *ngIf="project.buildNumbers.alpha">{{project.buildNumbers.alpha}}</span>
						</div>
					</div>
				</div>
			</div>

			<div class="type-row">
				<div (click)="switchTypeFilter(false)" [class.high]="!typeFilter" class="type-tab high">All</div>
				<div (click)="switchTypeFilter('news')" [class.high]="typeFilter == 'news'" class="type-tab">News</div>
				<div (click)="switchTypeFilter('changelogs')" [class.high]="typeFilter == 'changelogs'" class="type-tab">Changelogs</div>
				<div (click)="switchTypeFilter('issues')" [class.high]="typeFilter == 'issues'" class="type-tab">Issues</div>
			</div>
		</div>


		<div class="loader" *ngIf="!events && !fetchError">
			<img src="/assets/loader.svg">
		</div>
		<div class="errorMessage" *ngIf="fetchError">
			<h4>An error occurred while fetching the timeline</h4>
			<p>This could be due to outage of the API server or due to your browser blocking the requests. If you have
				an
				ad-blocker enabled, try to disable it and reload the page. Trust me, there are no ads or trackers here,
				only
				important API requests.</p>
		</div>

		<div class="events" *ngIf="events">
			<div class="event" *ngFor="let event of events">
				<div class="issue" *ngIf="event.type=='issue'">
					<h3 class="project-title">
						{{event.project}}
						<span class="after-project"
							[ngClass]="{'color-red': !event.resolved, 'color-green': event.resolved}">{{event.title}}</span>
					</h3>

					<div class="event-body entries">
						<div class="border" [ngClass]="{'border-red': !event.resolved, 'border-green': event.resolved}">
						</div>
						<div>
							<ul>
								<li class="entry" *ngFor="let entry of event.entries">
									{{entry.text}}
									<span class="sub-text">{{entry.time}}</span>
								</li>
							</ul>
						</div>
					</div>
				</div>

				<div class="release" *ngIf="event.type=='release'">
					<h3 class="project-title">
						{{event.project}}
						<span class="release-build"
							[ngClass]="{alpha: event.tag=='alpha', beta: event.tag=='beta'}">{{event.build}}
							{{event.tag}}</span>
					</h3>

					<p class="release-desc" *ngIf="event.description">{{event.description}}</p>

					<div class="release-changes" [ngClass]="{alpha: event.tag=='alpha', beta: event.tag=='beta'}">

						<div class="changes-group added" *ngIf="event.changes.added && event.changes.added.length">
							<h3 class="changes-group-title">Added</h3>

							<div class="row">
								<div class="border"></div>
								<div>
									<ul>
										<li class="release-change" *ngFor="let change of event.changes.added">
											{{change}}
										</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="changes-group updated"
							*ngIf="event.changes.updated && event.changes.updated.length">
							<h3 class="changes-group-title">Updated</h3>

							<div class="row">
								<div class="border"></div>
								<div>
									<ul>
										<li class="release-change" *ngFor="let change of event.changes.updated">
											{{change}}
										</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="changes-group fixed" *ngIf="event.changes.fixed && event.changes.fixed.length">
							<h3 class="changes-group-title">Fixed</h3>

							<div class="row">
								<div class="border"></div>
								<div>
									<ul>
										<li class="release-change" *ngFor="let change of event.changes.fixed">
											{{change}}
										</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="changes-group removed"
							*ngIf="event.changes.removed && event.changes.removed.length">
							<h3 class="changes-group-title">Removed</h3>

							<div class="row">
								<div class="border"></div>
								<div>
									<ul>
										<li class="release-change" *ngFor="let change of event.changes.removed">
											{{change}}
										</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="changes-group code" *ngIf="event.changes.code && event.changes.code.length">
							<h3 class="changes-group-title">Code changes</h3>

							<div class="row">
								<div class="border"></div>
								<div>
									<ul>
										<li class="release-change" *ngFor="let change of event.changes.code">
											{{change}}
										</li>
									</ul>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>
</div>